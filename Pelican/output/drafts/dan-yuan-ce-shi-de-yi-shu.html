<!DOCTYPE html>
<html lang="zh_tw">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://richardrobot.xyz/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://richardrobot.xyz/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Richard" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="單元測試的藝術, 後端程式, " />

<meta property="og:title" content="單元測試的藝術 "/>
<meta property="og:url" content="https://richardrobot.xyz/drafts/dan-yuan-ce-shi-de-yi-shu.html" />
<meta property="og:description" content="單元測試的藝術" />
<meta property="og:site_name" content="Richard隨手筆記" />
<meta property="og:article:author" content="Richard" />
<meta property="og:article:published_time" content="2022-03-29T19:37:00+08:00" />
<meta property="og:article:modified_time" content="2022-03-29T19:37:00+08:00" />
<meta name="twitter:title" content="單元測試的藝術 ">
<meta name="twitter:description" content="單元測試的藝術">

        <title>單元測試的藝術  · Richard隨手筆記
</title>
        <link href="https://richardrobot.xyz/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Richard隨手筆記 - Full Atom Feed" />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Q3D0B7D25R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Q3D0B7D25R');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4119678220307625" crossorigin="anonymous"></script>



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://richardrobot.xyz/"><span class=site-name>Richard隨手筆記</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://richardrobot.xyz
                                    >Home</a>
                                </li>
                                <li ><a href="https://richardrobot.xyz/categories.html">Categories</a></li>
                                <li ><a href="https://richardrobot.xyz/tags.html">Tags</a></li>
                                <li ><a href="https://richardrobot.xyz/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://richardrobot.xyz/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://richardrobot.xyz/drafts/dan-yuan-ce-shi-de-yi-shu.html">
                單元測試的藝術
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <h2 id="part-i"><span class="caps">PART</span> I 入門<a class="headerlink" href="#part-i" title="Permanent link">&para;</a></h2>
<h3 id="chapter-1"><a href="https://richardrobot.xyz/drafts/chapter-1-dan-yuan-ce-shi-ji-chu.html">Chapter 1 單元測試基礎</a><a class="headerlink" href="#chapter-1" title="Permanent link">&para;</a></h3>
<p>1.1 逐步定義單元測試
1.1.1 撰寫優秀單元測試的重要性
1.1.2 我們都寫過（某種）單元測試
1.2 優秀單元測試的特質
1.3 整合測試
1.3.1 與自動化單元測試相比，非自動化整合測試的缺點
1.4 什麼是優秀的單元測試
1.5 一個簡單的單元測試範例
1.6 測試驅動開發
1.7 成功進行TDD 的三種核心技能
1.8&nbsp;小結</p>
<h3 id="chapter-2"><a href="https://richardrobot.xyz/drafts/chapter-2-di-yi-ge-dan-yuan-ce-shi.html">Chapter 2 第一個單元測試</a><a class="headerlink" href="#chapter-2" title="Permanent link">&para;</a></h3>
<p>2.1 單元測試框架
2.1.1 單元測試框架提供哪些東西
2.1.2 xUnit 框架
2.2 LogAn 專案介紹
2.3 NUnit 的第一個步驟
2.3.1 安裝NUnit
2.3.2 載入方案的方式
2.3.3 在程式中使用NUnit 的特性
2.4 撰寫第一個測試程式
2.4.1 Assert 類別
2.4.2 用NUnit 執行第一個測試
2.4.3 增加正向的測試
2.4.4 由紅到綠：測試成功
2.4.5 測試程式風格
2.5 使用參數來重構測試
2.6 更多的NUnit 特性
2.6.1 setup 和teardown
2.6.2 驗證預期的例外
2.6.3 忽略此測試
2.6.4 NUnit 的流利語法
2.6.5 設定測試分類
2.7 測試系統狀態的改變，而非驗證回傳值
2.8&nbsp;小結</p>
<h2 id="part-ii"><span class="caps">PART</span> <span class="caps">II</span> 核心技術<a class="headerlink" href="#part-ii" title="Permanent link">&para;</a></h2>
<h3 id="chapter-3"><a href="https://richardrobot.xyz/drafts/chapter-3-tou-guo-xu-she-chang-shi-jie-jue-yi-lai-wen-ti.html">Chapter 3 透過虛設常式解決依賴問題</a><a class="headerlink" href="#chapter-3" title="Permanent link">&para;</a></h3>
<p>3.1 虛設常式簡介
3.2 找到LogAn 中對檔案系統的依賴
3.3 如何讓測試LogAnalyzer 更簡單
3.4 重構設計以提昇程式碼的可測試性
3.4.1 擷取介面以便替換底層實作內容
3.4.2 依賴注入：在被測試單元中注入一個假的實作內容
3.4.3 從建構函式注入一個假物件（建構函式注入）
3.4.4 用假物件來模擬異常
3.4.5 透過屬性get 或set 注入假物件
3.4.6 在呼叫方法之前才注入假物件
3.5 重構技術的變形
3.5.1 透過擷取與覆寫直接模擬假結果
3.6 克服封裝的問題
3.6.1 使用internal 和[InternalsVisibleTo]
3.6.2 使用[Conditional] 特性
3.6.3 使用 #if 和 #endif 進行條件編譯
3.7&nbsp;小結</p>
<h3 id="chapter-4"><a href="https://richardrobot.xyz/drafts/chapter-4-shi-yong-mo-ni-wu-jian-yan-zheng-hu-dong.html">Chapter 4 使用模擬物件驗證互動</a><a class="headerlink" href="#chapter-4" title="Permanent link">&para;</a></h3>
<p>4.1 基於值、狀態與互動的測試
4.2 模擬物件和虛設常式物件的差異
4.3 手刻模擬物件的簡單範例
4.4 同時使用模擬物件和虛設常式物件
4.5 每個測試只用一個模擬物件
4.6 假物件鏈：用虛設常式物件來產生模擬物件或其他虛設常式物件
4.7 手刻模擬物件和虛設常式物件的問題
4.8&nbsp;小結</p>
<h3 id="chapter-5">[[Chapter 5 隔離（模擬）框架]]<a class="headerlink" href="#chapter-5" title="Permanent link">&para;</a></h3>
<p>5.1 為什麼要使用隔離框架
5.2 動態產生假物件
5.2.1 在測試中使用NSubstitute
5.2.2 用動態假物件來取代手刻假物件
5.3 模擬回傳值
5.3.1 同時使用模擬物件和虛設常式物件
5.3.1.1 驗證物件是帶著某些屬性的情況
5.4 測試事件相關的活動
5.4.1 測試事件監聽者
5.4.2 測試事件是否觸發
5.5 現有的.<span class="caps">NET</span> 隔離框架
5.6 隔離框架的優缺點
5.6.1 使用隔離框架時應避免的陷阱
5.6.2 測試程式可讀性變差
5.6.3 驗證了錯誤的東西
5.6.4 一個測試中有多個模擬物件
5.6.5 過度指定的測試
5.7&nbsp;小結</p>
<h3 id="chapter-6">Chapter 6 深入了解隔離框架<a class="headerlink" href="#chapter-6" title="Permanent link">&para;</a></h3>
<p>6.1 受限框架和不受限框架
6.1.1 受限框架
6.1.2 不受限框架
6.1.3 基於探查器的不受限框架是如何運作的
6.1.4 框架揭露了不同的探查器能力
6.2 好的隔離框架的價值
6.3 支援適應未來和可用性的功能
6.3.1 遞迴假物件
6.3.2 預設忽略參數
6.3.3 大範圍偽造
6.3.4 假物件的非嚴格行為
6.3.5 非嚴格模擬物件
6.4 隔離框架設計反模式
6.4.1 概念混淆
6.4.2 錄製與重播
6.4.3 黏性行為
6.4.4 語法過於複雜
6.5&nbsp;小結</p>
<h2 id="part-iii"><span class="caps">PART</span> <span class="caps">III</span> 測試程式碼<a class="headerlink" href="#part-iii" title="Permanent link">&para;</a></h2>
<h3 id="chapter-7">Chapter 7 測試階層和組織<a class="headerlink" href="#chapter-7" title="Permanent link">&para;</a></h3>
<p>7.1 執行自動化測試的自動化建置
7.1.1 建置腳本結構
7.1.2 觸發建置和整合
7.2 依據速度和種類對應的測試分類
7.2.1 分開整合測試和單元測試的人為因素
7.2.2 綠色安全區域
7.3 確保測試程式是版本庫管理的一部分
7.4 將測試類別的位置與被測試程式相對應
7.4.1 將測試對應到專案
7.4.2 把測試對應到類別
7.4.3 將測試對應到明確的工作單元入口
7.5 注入橫切面關注點
7.6 為應用程式建立測試API
7.6.1 使用繼承類別繼承模式
7.6.2 建立測試輔助類別和方法
7.6.3 把你的API 介紹給開發人員
7.7&nbsp;小結</p>
<h3 id="chapter-8">Chapter 8 好的單元測試的支柱<a class="headerlink" href="#chapter-8" title="Permanent link">&para;</a></h3>
<p>8.1 撰寫可信任的測試
8.1.1 決定何時刪除或修改測試
8.1.2 避免測試中帶著邏輯
8.1.3 每次只測試一個關注點
8.1.4 把單元測試和整合測試分開
8.1.5 用程式碼審查確保程式碼覆蓋率
8.2 撰寫可維護的測試
8.2.1 測試私有或保護的方法
8.2.2 去除重複的程式碼
8.2.3 具可維護性的設計來使用Setup 方法
8.2.4 實作測試隔離
8.2.5 避免對不同的關注點進行多次驗證
8.2.6 物件比較
8.2.7 避免過度指定
8.3 撰寫可讀性高的測試
8.3.1 單元測試的命名
8.3.2 變數命名
8.3.3 有意義的驗證
8.3.4 驗證和操作分離
8.3.5 setup 和teardown
8.4&nbsp;小結</p>
<h2 id="part-iv"><span class="caps">PART</span> <span class="caps">IV</span> 設計與流程<a class="headerlink" href="#part-iv" title="Permanent link">&para;</a></h2>
<h3 id="chapter-9">Chapter 9 在組織中導入單元測試<a class="headerlink" href="#chapter-9" title="Permanent link">&para;</a></h3>
<p>9.1 逐步成為導入變革的領頭羊
9.1.1 準備好面對各種質疑
9.1.2 說服組織內成員：支持者和反對者
9.1.3 找到可能的切入點
9.2 成功之道
9.2.1 游擊式的進行（從下而上）
9.2.2 說服高層（從上而下）
9.2.3 引入外援
9.2.4 讓進度可見
9.2.5 設定具體目標
9.2.6 應對阻礙
9.3 失敗原因
9.3.1 缺乏驅動力
9.3.2 缺乏政策支援
9.3.3 糟糕的實現和第一印象
9.3.4 缺少團隊支持
9.4 影響因素
9.5 質疑和回答
9.5.1 現有流程加入單元測試需增加多少時間
9.5.2 單元測試是否會搶了QA 飯碗
9.5.3 證明單元測試確實有效的方式
9.5.4 單元測試有用的證據
9.5.5 <span class="caps">QA</span> 部門還是能夠找到bug 的原因
9.5.6 我們有大量未經測試的程式碼，應該從哪裡開始
9.5.7 我們使用了多種程式語言：單元測試是否可行
9.5.8 軟硬體結合的開發
9.5.9 確保測試中沒有bug 的方式
9.5.10 偵錯器已經證明我的程式沒問題，但還需要測試的原因
9.5.11 測試驅動開發的必要性
9.6&nbsp;小結</p>
<h3 id="chapter-10">Chapter 10 遺留程式碼<a class="headerlink" href="#chapter-10" title="Permanent link">&para;</a></h3>
<p>10.1 從哪裡開始加入測試
10.2 決定選擇策略
10.2.1 先易後難策略的優缺點
10.2.2 先難後易策略的優缺點
10.3 在重構前撰寫整合測試
10.4 針對遺留程式碼進行單元測試的重要工具
10.4.1 使用不受限的隔離框架來輕鬆隔離依賴項
10.4.2 使用JMockit 測試Java 遺留程式碼
10.4.3 重構Java 程式碼時使用Vise
10.4.4 重構前使用驗收測試
10.4.5 閱讀Michael Feathers 關於遺留程式碼的書
10.4.6 使用NDepend 來分析產品程式碼
10.4.7 使用ReSharper 瀏覽和重構產品程式碼
10.4.8 使用Simian 和TeamCity 發現重複的程式碼（和bug）
10.5&nbsp;小結</p>
<h3 id="chapter-11">Chapter 11 設計與可測試性<a class="headerlink" href="#chapter-11" title="Permanent link">&para;</a></h3>
<p>11.1 為什麼在設計的時候要關心可測試性
11.2 可測試性的設計目標
11.2.1 預設情況下將方法設定為虛擬方法
11.2.2 使用介面導向的設計
11.2.3 預設情況下將類別設計成可繼承的
11.2.4 避免在包含邏輯的方法裡面初始化具體類別
11.2.5 避免直接呼叫靜態方法
11.2.6 避免在建構式和靜態建構式中包含邏輯程式碼
11.2.7 把單例邏輯和單例持有者分開
11.3 可測試性設計的利弊
11.3.1 工作量
11.3.2 複雜度
11.3.3 洩漏敏感的智慧財產權
11.3.4 有時無法進行
11.4 可測試性設計的替代方案
11.4.1 設計爭論與動態型別語言
11.5 難以測試設計的範例
11.6 小結
11.7&nbsp;更多資源</p>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2022-03-29T19:37:00+08:00">二 29 3月 2022</time>

            <h4>Category</h4>
            <a class="category-link" href="https://richardrobot.xyz/categories.html#hou-duan-cheng-shi-ref">後端程式</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://richardrobot.xyz/tags.html#dan-yuan-ce-shi-de-yi-shu-ref">單元測試的藝術
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
    <a href="https://www.linkedin.com/in/jarvis-zheng-13a2b990" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://github.com/TernenceZheng" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="andy711023@gmail.com" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Gmail" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#fff"/><rect width="362" height="272" x="75" y="120" fill="#f2f2f2" rx="8%"/><path fill="#d54c3f" d="M120 392H97c-12 0-22-10-22-23V143h45z"/><path fill="#b63524" d="M392 392h23c12 0 22-10 22-23V143h-45z"/><path fill-opacity=".05" d="M256 286L120 392V187z"/><path fill-opacity=".08" d="M82 159l235 233h75V159z"/><path stroke-linecap="round" fill="none" stroke="#de5145" stroke-width="45" d="M97 143l159 115 159-115"/><path fill="#f2f2f2" d="M415 120c-5 0-10 2-13 4L256 230 110 124c-3-2-8-4-13-4z"/></svg>
    </a>
    <a href="https://richardrobot.xyz/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>

    <div>
        <span class="site-name">Richard隨手筆記</span> - 紙上得來終覺淺，絕知此事要躬行
    </div>



    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://richardrobot.xyz/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>