---
title: 11.以工具實作的剖面導向程式設計
date: 2022-05-30 18:13
modified: 2022-05-30 18:13
tags: 標籤
category: 後端程式
slug:
summary: 預覽標題
image: /images/default_preview_image.jpg
status: draft
---

[TOC]


## 動態攔截

所謂的動態攔截，就是幫助你在『執行期階段』才產生出裝飾元件類別的函式庫功能。

使用工具：
Castle Dynamic Proxy 動態代理(動態攔截)，詳細內容另開 [[代理模式]] 來瞭解實做
ASP.NET MVC的Action過濾器是不是也是動態攔截的AOP做法？需要確認

| 缺點                 | 簡述                                                                                                         |
| -------------------- | ------------------------------------------------------------------------------------------------------------ |
| 無法獲得編譯期的支援 | 攔截器的程式碼將會看起來較單純的裝飾元件複雜，無論是可閱讀性貨可維護性都下降                                 |
| 剖面實做被工具所限定 | 這層耦合關係會讓測試變複雜，而且只能讓攔截器作爲組合根的一部分，否則其他專案組件檔也依賴於這份動態攔截函式庫 |
| 不是真正可通用的做法 | 剖面只能套用在這些抽象方法上，也就是只能限定在抽象介面有定義的方法上                                         |
| 無法解決設計面的問題 | 系統的可維護性稍微提高，但是比SOLID五原則的設計面解決方案仍舊不足                                                                                                             |



另外一個DI反模式：

## 利用後編譯織入實做剖面關切點

| 缺點             | 簡述                                                                                                           |
| ---------------- | -------------------------------------------------------------------------------------------------------------- |
| 對DI架構有害     | 你無法往後編譯織入的剖面中注入不穩定依賴對象。如果真這樣做，又會產生時序耦合、被綁架的依賴、以及測試耦合等問題 |
| 在編譯期造成耦合 | 由於剖面是在編譯期間才寫進去的，因此你無法在剖面未被套用上去之前，就呼叫剖面的程式碼。提高了測試的複雜度、降低彈性                                                                                                               |


>關於上面 動態攔截與後編譯織入這兩個的缺點說明，需要再查詢網路上的一些說明才能真正瞭解上面說的那些缺點的真正原因。