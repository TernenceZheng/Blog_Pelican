---
title: 依賴注入的基礎：定義、理由與實作方法
date: 2022-04-13 08:50
modified: 2022-04-13 08:50
tags: 標籤
category: 後端程式
slug: 自定義URL標籤
summary: 預覽標題
image: /images/default_preview_image.jpg
status: draft
---

[TOC]

### 定義

>依賴注入是一套軟體設計的理論與模式，主要是為了開發出具備鬆耦合特性的程式碼


---

題外話：

什麼是『抽象工廠』

所謂抽象工廠是一種典型的抽象化介面，內含多個方法，每個方法都可以生產某一特定種類的物件。

抽象工廠模式典型的用法，就是用於使用者介面的 toolkits 或者客戶端應用程式，且它們需要在各種平臺上執行。為了能夠提高程式碼在各種平臺的重複使用率，舉例來說，你可以定義一個名為 `IUIcontrolFactory` 的抽象介面，裡面提供特定物件的建立，如提供給消費者的文字方塊或是按鈕等等：

```c#
	public interface IUIcontrolFactory
	{
		IButton CreateButton();
		ITextBox CreateTextBox();
	}
```

你可以在同一個 `IUIcontrolFactory` 底下，針對所有作業系統（OS）提供不同的實作。雖然上例只有列出兩個方法，但是可以根據應用程式貨工具的需求，設計出更多方法在其中。

重點是，抽象工廠介面中所提供的方法，都是事先定義好的。

---

在鬆耦合架構中編寫程式時，最輕鬆的部分是設計介面，不是開發實體類別，而需要思考的問題是『物件要從哪裡來？』這也就是全書篇幅要探討的問題，而且也就是DI所圍繞著、要思考解決的核心問題。


### 適合與不適合注入的對象

一個應用程式要判斷是否適合使用依賴注入，或是說將應用程式改為介面操作，主要就是判斷穩不穩定，能夠將依賴性關係分辨為穩定（stable）或是不穩定（volatile）是在初學DI時很重要的一項能力，這種設定接合口的決策能力很快就會內化為一種直覺。

NOTE：什麼是接合口
每當你決定要在程式碼中改為對介面操作，而非直接使用實體型別時，就像是在應用程式上安裝一個接合口。這個接合口就是應用程式用來跟其他零件組裝的部分。

#### 穩定依賴性
一般情況而言，大部分BCL函式庫中的型別都屬於『穩定依賴性』，要能稱為穩定依賴性的都要符合以下這些重要性質：

- 類別或模組不需要另外準備
- 即使版本更新也不會導致運作異常
- 程式的演算法或行為模式必須要是可預期的結果
- 不會想要把這些類別或模組用其他的類別或模組進行替換包裝裝飾

#### 不穩定依賴性

- 因為這份依賴性關係對象，應用程式因此而需要準備或設定執行期階段的環境
- 這份依賴性關係對象方位開發完成，或是還無法安裝或準備
- 不是開發單位中所有設備都能安裝這份依賴性關係對象
- 依賴性關係對象有著無法被預期的行為模式

##### 重要

---

不穩定依賴性關係可說就是DI架構所針對的病灶，比起穩定依賴性對象，更應該利用接合口拆開與不穩定依賴性對象之間的關係。這同樣也是驅使你採用DI架構來組合這些關係的動力之一

---


### 依賴注入在軟體中牽涉的範疇

要說明依賴注入其實就是一套的程式設計原則，單這個詞彙所牽涉的領域逐漸擴展直至今日還包含了『對物件生命週期的控制』『對物件的攔截』，最主要的還是『為了物件組合的控制權』問題。

